---
title: "Artículo 3 - Clasificador naïve Bayes"
author:
  - name: "Barush Caliel C. Luna"
    affiliation: "1"
  - name: "Diego B. Castillo"
    affiliation: "1"
  - name: "Pedro Emilio S. Rodríguez"
    affiliation: "1"
  - name: "Vidal Alejandro G. López"
    affiliation: "1"
affiliation:
  - id: "1"
    institution: "Instituto Tecnológico de Estudios Superiores de Monterrey"
date: "09/14/2025"
abstract: | 
 This project develops a comprehensive web scraping pipeline to collect and organize firsthand paranormal experience narratives from Your Ghost Stories, an online repository of supernatural reports worldwide. Using R tools such as rvest, stringr, and purrr, we systematically extracted categorical metadata and full story texts by navigating the site's categorized and paginated structure. The methodology ensured legal compliance through robot.txt validation and incorporated robust error handling to overcome challenges related to URL parameter concatenation and page navigation. The resulting structured dataset enables advanced text mining and probabilistic classification models, such as Naïve Bayes, to analyze linguistic patterns and categorize paranormal events effectively, laying groundwork for enhanced understanding of narrative-based paranormal phenomena.
keywords: [Naïve Bayes classifier, Paranormal narratives, Web scraping, Natural language processing (NLP), Text mining, Probabilistic modeling, Data Extraction]
format:
  html:
    toc: true
    number-sections: true
    code-fold: true
    theme: lumen
  pdf:
    documentclass: article
    toc: true
    number-sections: true
    latex-engine: xelatex
    #classoption: twocolumn #esto es para las dos columnas
    keep-tex: false
execute:
  echo: true
  warning: false
  error: false
editor: 
  markdown: 
    wrap: 72
---

# Introducción

El análisis de texto y la clasificación automática de narrativas se han convertido en herramientas fundamentales dentro de la ciencia de datos para explorar y entender grandes volúmenes de información no estructurada. En este proyecto, se aborda el reto de clasificar relatos de fenómenos paranormales recopilados en línea, provenientes de la página web Your Ghost Stories, que contiene una extensa base de datos de experiencias sobrenaturales narradas por usuarios. La naturaleza subjetiva y diversa de estas historias hace que su categorización sea especialmente compleja, pues involucra distintos tipos de fenómenos y estilos narrativos que desafían los métodos tradicionales de análisis.

Para resolver este problema, se implementa una metodología basada en técnicas computacionales de web scraping para la extracción automatizada de grandes cantidades de datos textuales, asegurando el respeto a las políticas del sitio mediante el uso del paquete robotstxt. Posteriormente, se procesa la información obtenida utilizando herramientas del paquete tidyverse para la limpieza, normalización y tokenización del texto, creando matrices dispersas de frecuencia de palabras que constituyen la representación numérica de los relatos.

Se emplean modelos probabilísticos, específicamente clasificadores Naïve Bayes, para asignar etiquetas a cada relato según el tipo de evento paranormal, enfrentando los retos de la alta dimensionalidad y sparsidad típica en problemas de análisis de texto. Además, se exploran técnicas de suavizamiento y validación cruzada para optimizar el desempeño del modelo.

Este trabajo tiene como objetivo no solo desarrollar una solución automatizada para la clasificación multiclase de relatos paranormales, sino también contribuir con un conjunto de datos estructurado y una metodología reproducible que facilite futuros análisis en este campo interdisciplinario.

# Métodos

## Recolección de datos

La recolección de datos se realizó mediente técnicas de web scrapping aplicadas al sitio web Your Ghost Stories, una fuente de relatos paranormales publicados por usuarios de distintas partes del mundo. Se utilizó el lenguaje R y varios paquetes especializados, cómo rvest para la extracción de contenido HTML y string para la manipulación de texto. Los datos obtenidos incluyen tanto los metadatos categóricos, como tipo de fenómeno paranormal, fecha, ubicación, como el texto completo de cada relato. Finalmente, la información fue almacenada en un dataset en formato CSV, facilitando su análisis y procesamiento.

## Preprocesamiento de texto

Para iniciar con el _scrapping_, el primer paso fue colocar el algoritmo dentro de las páginas y obtener los identificadores del HTML por medio de la consola inspeccionando el _body_ de la página. A la vez, como pasos previos, se probó con el método `paths_allowed()` para saber si la página era posible realizarle un _scrapping_. Confirmando estos elementos el procesamiento del texto se realizó con herramientas del paquete
**tidyverse**, y los siguientes pasos:

Se identificaron los `<li>` ligadores al ID del objeto de texto de las categorías  (siendo en total 20). Posteriormente en un ciclo con métodos de las librerías _rvest_, _dplyr_, _stringr_ y _purrr_ para ligar identificadores y extraer 100 relatos por categorías. 

Se hizo uso de del lenguaje de programación Python para la \-**Tokenización:** separación del texto en palabras, para facilitar el análisis cuantitativo en vectores. Una vez con estos vectores, se aplicó una **Eliminación de stop words:** remoción de palabras comunes y poco informativas, usando una lista predefinida en R llamada **stop_words**. 

Asimismo, en Python se creó la _sparse matrix_ con 15000 _features_. En esta matriz, cada palabra representaba una columna o variable con una variable añadida de la categoría. Cada observación estaba constituida de las veces que se repetía tal palabra en un relato según su categoría. Para facilitar el intercambio de datos entre lenguajes de programación, se guardó la matriz en un DataFrame de la librería `pandas`para exportarlo como un archivo csv. 

## Análisis de frecuencia de palabras

Se siguió la metodología planteada por el artículo _STA 199 - He replied / she cried: Text mining and gender roles_ (s.f.), en donde por medio del lenguaje de programación R, se cuentan la frecuencia de las palabras y se grafican según la categoría. Asimismo, se planteó una comparación relativa de palabras posteriores a _he_ y _she_ para revisar las tendencias de los relatos de fantastas. 


## Implementación del modelo

Para la clasificación, se implementaron modelos probabilísticos basados
en el clasificador Naïve-Bayes, con las siguientes características:

\-**Naïve-Bayes Gaussiano:** asumiendo que las características,
frecuencias de palabras, siguen una distribución de normal para modelar
los datos continuos. 

-**Distribución de Poisson:** explorada para
modelar el conteo de palabras en cada relato, dado que es una variable
discreta y frecuentemente dispersa. 

-**Suavizamiento Laplace:** aplicado
para evitar probabilidades cero en categorías con palabras poco
frecuentes, mejorando así la robustez del clasificador.

-**Cross-validation:** se utilizó $cross-validation$ para evaluar la
generalización del modelo y ajustar hiperparámetros, minimizando el
sobreajuste y maximizando la precisión predictiva.

# Aplicación al problema de narrativas paranormales

Para evaluar el desempeño del clasificador Naïve Bayes en la
categorización de relatos paranormales, se dividió el conjunto de datos
en dos subconjuntos:

-   **Conjunto de entrenamiento (training set):** que comprende un 70%
    aleatorio de los relatos, utilizado para ajustar los parámetros del
    modelo.
-   **Conjunto de prueba (test set):** con el 30% restante, utilizado
    para validar la capacidad de generalización del clasificador.

Esta partición aleatoria garantizó que ambas muestras mantuvieran una
distribución representativa de las diferentes clases de fenómenos
paranormales, preservando el balance de etiquetas.

Se aplicaron y compararon distintas variantes del modelo Naïve Bayes,
incluyendo el gaussiano, con distribución de Poisson y con suavizamiento
Laplace. Para cada modelo se calcularon métricas de rendimiento como
precisión, sensibilidad, especificidad y el valor F1 mediante la matriz
de confusión generada con el conjunto de prueba.

Este enfoque experimental facilitó una comparación rigurosa y objetiva
entre modelos probabilísticos para la correcta interpretación y
predicción de eventos paranormales narrados en formatos textuales no
estructurados.

# Resultados

Se realizaron gráficas de frecuencia de las 10 palabras más repetidas
por las 20 categorías. Una muestra de estas, es la primera categoría *A
Haunted Life*:

```{r, fig.cap="Top 10 palabras más frecuentes A Haunted Life"}
#| echo: false
library(tidyverse)
library(tidytext)
library(knitr)
library(janeaustenr) 

read_rds("objetos/diagrama_frecuencia_cat.rds")
```

```{r fig.height=10, fig.width=12, fig.cap="Top 5 palabras más frecuentes por categoría."}
#| echo: false
read_rds("objetos/diagrama_top.rds")
```

Se comparó qué palabras seguían después de los artículos, en inglés,
*he* y *she*:

```{r, fig.cap="Comparación de he y she en dataset"}
#| echo: false
diagrama= read_rds("objetos/diagrama_he_she.rds")
diagrama 
```

A continuación, se presentan los resultados experimentales obtenidos con el análisis y modelos aplicados al conjunto de relatos paranormales.

El número total de relatos clasificados fue 1856, distribuidos en 20 categorías de fenómenos paranormales. La distribución por categoría fue equilibrada, con 100 relatos en la mayoría de las categorías, excepto en algunas como "Ghost Tours & Haunted Hotels" con 71 y "Haunted Items" con 46 relatos.

Se construyó la matriz de confusión para evaluar el desempeño del clasificador Naïve Bayes (implementado con el paquete e1071), la cual mostró una precisión global baja (Accuracy: 0.0539), indicando dificultades para clasificar correctamente las distintas categorías.

Algunas métricas por clase destacan que para la categoría "Photographs / Videos / EVP" se alcanzó un Recall de 1, pero con una Precisión muy baja (0.0563), y para "Shadow People" la precisión y recall fueron también muy bajas. Las demás categorías presentan métricas muy pobres reflejando que el modelo tiene problemas para discriminar entre las clases.

El modelo Naïve Bayes con suavizamiento Laplace (Laplace smoothing) fue evaluado mediante validación cruzada 3-fold, dando como mejor parámetro Laplace = 0 y sin kernel (usekernel = FALSE). La matriz de confusión y métricas con este suavizamiento no mejoraron la precisión global que se mantuvo en 0.0539. Los promedios macro para precisión, recall y F1-score se ubicaron alrededor de 0.0042, 0.0524 y 0.0071 respectivamente, lo cual indica un desempeño insuficiente en el contexto de clasificación multiclase con alta dimensionalidad y sparsidad.

Además, se observó que el modelo tiende a predecir mayormente algunas clases específicas, generando desbalance en las predicciones, posiblemente por la falta de ejemplos o la complejidad del corpus textual.

Estos resultados sugieren que, aunque el enfoque Naïve Bayes es conceptualmente adecuado para problemas de texto, en este caso particular requiere ajustes adicionales, selección de características más efectiva, o el uso de modelos más complejos para mejorar la clasificación.

# Análisis de Resultados

Dentro de las 20 categorías, las palabras que más se repetían
(utilizando `stop_words`) fueron *time*, *house*, *bed*, *ghost* entre
otras. Esto puede indicanar que las historias dentro del conjunto de
datos, sus relatos tiene relación con alguna línea temporal; casas
abandonadas, habitadas o *malditas*; camas en diversos contextos; y
fantasmas. A la vez, dependiendo de las categorías, hay palabras que
diferencian; por ejemplo, en *Family/Friends Visits*, la palabra *mom*
es de las más comunes. Mismo efecto sucede en categorías como *Not Human
Entities*, la palabra *eyes* es frecuente, pudiendo indicar que la
conexión entre figuras no antropomorfas, los ojos siguen persistiendo.

Dentro de la gráfica de *Comparación de "he" y "she en dataset*, verbos
como *screamed*, *responded* y *laid* aparecen significativamente más
con *she*, mientras que *loves*, *drove* y *made* se asocian más con
*he*. Algunos verbos cercanos al eje central muestran un uso balanceado.
Estos patrones sugieren estereotipos implícitos en los textos, donde
acciones de comunicación o emocionalidad predominan con *she* y acciones
físicas o de actividad con *he*. La magnitud del sesgo se refleja en la
distancia respecto a 1, siendo, por ejemplo, *screamed* más de cuatro
veces más frecuente con *she*.

# Conclusiones

Se trabajó con un conjunto de datos que contenía 1856 relatos clasificados en 20 categorías relacionadas con experiencias paranormales, incluyendo "A Haunted Life", "Apparitions / Voices / Touches", "Children Who See Spirits", entre otras. Para el análisis, se aplicaron modelos de clasificación Naive Bayes usando diferentes paquetes y configuraciones en R, como e1071, naivebayes y caret. Sin embargo, los resultados mostraron un desempeño muy bajo en la clasificación, con una precisión global alrededor del 5.39%, y métricas de precisión, recall y F1-Score extremadamente bajas para casi todas las categorías, lo que indica que el modelo no logró aprender a distinguir efectivamente entre las diversas clases.

Los intentos de optimización incluyeron el uso de suavizado Laplace con diferentes valores, pero no mejoraron significativamente el rendimiento del modelo. Las matrices de confusión reflejan que el modelo prácticamente no predice correctamente ninguna clase, con casi todos los valores en ceros y algunos aciertos marginales en categorías específicas como "Photographs / Videos / EVP". Esto sugiere que las características extraídas, compuestas por una gran cantidad de predictores (alrededor de 15,000), pueden no ser adecuadas o que el enfoque de modelado necesita ajustes más profundos, como selección de características, balanceo de clases o un método distinto de clasificación.

En conjunto, el trabajo refleja la complejidad de clasificar relatos paranormales en múltiples categorías y la necesidad de explorar estrategias más robustas para mejorar la capacidad predictiva de los modelos entrenados


# Referencias

-   Wickham, H., Çetinkaya-Rundel, M., & Grolemund, G. (2017). *R for
    Data Science*. O’Reilly Media.\

-   Silge, J., & Robinson, D. (2017). *Text Mining with R: A Tidy
    Approach*. O’Reilly Media.\

-   Meyer, D., Dimitriadou, E., Hornik, K., Weingessel, A., & Leisch, F.
    (2021). *naivebayes: Naive Bayes Classifier for Discrete and
    Continuous Features*. R package.

-   Nigam, J. (2025, 8 enero). *What is CountVectorizer*. Medium.
    https://medium.com/@jyotinigam2370/what-is-countvectorizer-961d37e9a290

-   *STA 199 - He replied / she cried: Text mining and gender roles*.
    (s.f.). https://sta199-f22-1.github.io/ae/ae-21-jane-austen-A.html

-   Ganesan, K. (2023, 16 marzo). *What are Stop Words?* Kavita Ganesan,
    PhD. https://kavita-ganesan.com/what-are-stop-words/
